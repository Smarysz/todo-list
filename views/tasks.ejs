<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDL</title>
    <link rel="stylesheet" href="css/global.css">
</head>

<body class="id-<%= locals.pageID || 'none' %>" data-pageid="<%= locals.pageID %>">
    <%- include('header') %>
    <div class="main-container">
        <%
            let utc = dtc = 0;
            locals.data.forEach(e => {
                if(!e.done) utc++;
                else dtc++;
            });
        %> 
        <h1 class="center mb-2">Undone tasks (<span id="undone-task-count"><%= utc %></span>)</h1>
        <%
            let undoneTasks = `<thead><tr>
                    <th>Task</th>
                    <th>Deadline</th>
                    <th>Priority</th>
                    <th>Edit</th>
                    <th>Confirm</th>
                    <th>Remove</th>
                </tr></thead>`,
            doneTasks = `<thead><tr>
                    <th>Task</th>
                    <th>Deadline</th>
                    <th>Priority</th>
                    <th>Uncheck</th>
                    <th>Remove</th>
            </tr></thead>`;

            for(let row of locals.data) {
                if(!row.done) {
                    undoneTasks += `<tr class="undone-task" data-title="${row.title}" data-deadline="${row.deadline}" data-priority="${row.priority_name}" data-tid="${row.ID}">
                        <td class="undone-title">${row.title}</td>
                        <td class="undone-deadline">${row.deadline}</td>
                        <td class="undone-priority"><a class="priority-task">${row.priority_name}</a></td>
                        <td><a data-tid="${row.ID}" class="edit-task">Edit</a></td>
                        <td><a data-tid="${row.ID}" data-event="false" class="confirm-task">Confirm</a></td>
                        <td><a data-tid="${row.ID}" class="remove-task">Remove</a></td>
                    </tr>`;
                } else {
                    doneTasks += `<tr class="done-task" data-title="${row.title}" data-deadline="${row.deadline}" data-priority="${row.priority_name}" data-tid="${row.ID}">
                        <td class="done-title">${row.title}</td>
                        <td class="done-deadline">${row.deadline}</td>
                        <td class="done-priority"><a class="priority-task">${row.priority_name}</a></td>
                        <td><a data-tid="${row.ID}" data-event="false" class="uncheck-task">Uncheck</a></td>
                        <td><a data-tid="${row.ID}" class="remove-task">Remove</a></td>
                    </tr>`;
                }
            }

        %>
        <table class="tasks-table" id="undone-tasks-table" data-type="undone">
            <%- undoneTasks %>
        </table>
        <h1 class="center mb-2">Done tasks (<span id="done-task-count"><%= dtc %></span>)</h1>
        <table class="tasks-table" id="done-tasks-table" data-type="done">
            <%- doneTasks %>
        </table>
    </div>
    <script src="js/global.js"></script>
</body>

</html>